
.. backlink:

:mod:`simrun` ❭ :mod:`~simrun.synaptic_strength_fitting` ❭ :mod:`~simrun.synaptic_strength_fitting.run_ex_synapse`


.. title:

run_ex_synapse
==============


.. py:function:: simrun.synaptic_strength_fitting.run_ex_synapse(cell_nw_generator, neuron_param, network_param, celltype, preSynCellID, gAMPA=None, gNMDA=None, gGABA=None, vardt=False, return_cell=False, synapseID=None, tEnd=None, tStim=None)

   Simulate a single excitatory or inhibitory synapse

   This is the core function to activate a single synapse and run the simulation.
   Used in the :py:class:`~simrun.synaptic\_strength\_fitting.PSPs` class to simulate each synapse.

   For excitatory synapses, :paramref:`gAMPA` and :paramref:`gNMDA` must be specified, and not :paramref:`gGABA`.
   For inhibitory synapses, only :paramref:`gGABA` may be specified.

   :Parameters: * **cell\_nw\_generator** (*callable*) -- A callable that returns a :py:class:`~single\_cell\_parser.cell.Cell` and :py:class:`~single\_cell\_parser.network.NetworkMapper` when called.
                * **neuron\_param** (:py:class:`~single\_cell\_parser.parameters.ParameterSet`) -- The :ref:`cell\_parameters\_format`.
                * **network\_param** (:py:class:`~single\_cell\_parser.parameters.ParameterSet`) -- The :ref:`network\_parameters\_format`.
                * **celltype** (*str*) -- The celltype to activate the synapse for. Used to fetch the correct network parameters.
                * **preSynCellID** (*int*) -- The presynaptic cell ID to activate the synapse for. Default: ``None``.
                * **gAMPA** (*float*) -- The AMPA conductance value. Default: ``None``.
                * **gNMDA** (*float*) -- The NMDA conductance value. Default: ``None``.
                * **gGABA** (*float*) -- The GABA conductance value. Default: ``None``.
                * **vardt** (*bool*) -- Whether to use the variable step size solver. Default: ``False``.
                * **return\_cell** (*bool*) -- Whether to return the :py:class:`~single\_cell\_parser.cell.Cell` object. Default: ``False``.
                * **synapseID** (*int*) -- The synapse ID to activate.
                  If ``None``, all synapses assigned to the presynaptic cell get activated synchronously during the simulation.
                  Default: ``None``.
                * **tEnd** (*float*) -- The end time of the simulation. Default: ``None``.
                * **tStim** (*float*) -- The time of the synaptic activation. Default: ``None``.

   :returns: A tuple of the time vector and the voltage trace at the soma.
   :rtype: tuple


.. 
   Warning: we replace underscores with an escape backslash about 4 lines above to avoid having Sphinx interpret arguments as links.
   However, this may cause issues with code blocks or other literal text, and malform markdown tables
   Use with caution?
..